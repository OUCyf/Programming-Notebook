
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Matplotlib &#8212; Programming Notebook</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://seismology101.github.io/Notebook/geo_software/Matplotlib.html" />
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="PyGMT" href="PyGMT.html" />
    <link rel="prev" title="Geophysics Software" href="GeoSoftware.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Programming Notebook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction ✨
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Programming Environment
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Xcode.html">
   Xcode
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Homebrew.html">
   Homebrew
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Iterm2_Zsh.html">
   Iterm2 &amp; Zsh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/SSH.html">
   SSH &amp; SSHFS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Git.html">
   Git &amp; Github
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/VScode.html">
   VSCode
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Latex.html">
   Latex
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/GUN.html">
   GUN
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Python.html">
   Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Julia.html">
   Julia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Matlab.html">
   Matlab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Shell_Manual.html">
   Shell Manual
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../programming_environment/Shortcuts.html">
   Shortcuts
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  App Development
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../apps/Python_Package.html">
   Python Package
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../apps/Pyside6.html">
   Pyside6
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../apps/Dash.html">
   Dash
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../apps/Docker.html">
   Docker
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Parallel Computing and HPC Platform
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Python.html">
   Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Python_HPC.html">
   Python HPC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/C%2B%2B.html">
   C++
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Make_Cmake.html">
   Make Cmake
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Pybind11_Cython.html">
   Pybind11 Cython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Slurm.html">
   Slurm
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Globus.html">
   Globus
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Rice_NOTS.html">
   NOTS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Azure.html">
   Azure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../hpc/Amazon_S3.html">
   Amazon S3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  ML and DL
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ml_dl/Scipy.html">
   Scipy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ml_dl/PyTorch.html">
   PyTorch
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  MacOS Software
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../macos_software/MacSoftware.html">
   Mac Software
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../macos_software/ImageMagick.html">
   ImageMagick
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../macos_software/Otter.html">
   Otter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../macos_software/PROMISE_Utility.html">
   PROMISE Utility
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Geo Software
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="GeoSoftware.html">
   Geophysics Software
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Matplotlib
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="PyGMT.html">
   PyGMT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SAC.html">
   SAC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Obspy.html">
   Obspy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="DAS_format.html">
   DAS Data Format
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CPS.html">
   CPS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="SPECFEM.html">
   SPECFEM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Gmsh.html">
   Gmsh
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Paraview.html">
   Paraview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="FwiFlow.html">
   FwiFlow
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GEOSX.html">
   GEOSX
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Links
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../links/link.html">
   Links ✨
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://yinfu.info/">
   About Me
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/Seismology101/Notebook/main?urlpath=tree/book/geo_software/Matplotlib.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/Seismology101/Notebook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/Seismology101/Notebook/issues/new?title=Issue%20on%20page%20%2Fgeo_software/Matplotlib.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/geo_software/Matplotlib.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="../_sources/geo_software/Matplotlib.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-misfit-space">
   3D Misfit Space
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-histogram">
   1D Histogram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   2D Histogram
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Matplotlib</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-misfit-space">
   3D Misfit Space
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-histogram">
   1D Histogram
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   2D Histogram
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="matplotlib">
<h1>Matplotlib<a class="headerlink" href="#matplotlib" title="Permalink to this headline">#</a></h1>
<ul class="simple">
<li><p>Author: <em><a class="reference external" href="https://yinfu.info/">Fu Yin</a></em></p></li>
<li><p>Update: <em>August 6, 2022</em></p></li>
<li><p>Reading: <em>30 min</em></p></li>
</ul>
<hr class="docutils" />
<section id="d-misfit-space">
<h2>3D Misfit Space<a class="headerlink" href="#d-misfit-space" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#!/usr/bin/env python3
# -*- coding: utf-8 -*-
&quot;&quot;&quot;
Created on Tue May 25 22:44:49 2021

@author: yf
&quot;&quot;&quot;

import numpy as np
import os
import matplotlib.gridspec as gridspec
from matplotlib import pyplot as plt
from matplotlib.pyplot import MultipleLocator
import math
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm

#%% 1. input parameter
rank_path = &quot;./matplotlib_files/3d-mcmtpy/&quot;
MPI_n = 30
strike_num = 361                                                                # step:5度 = 73  ||  step:1度 = 361
rake_num = 361

Strike = 138                                                                    # rake 剖面时，选取strike的数值
Rake = -170                                                                     # strike 剖面时，选取rake的数值

Num_stem = 40


#%% 2. read data
for i in range(0, MPI_n, 1):
    FM_all_path = os.path.join(rank_path, &#39;rank_&#39;+str(i)+&#39;_FM_all&#39;)
    if i == 0:
        FM_all = np.loadtxt(FM_all_path)
    else:
        FM_all = np.vstack((FM_all, np.loadtxt(FM_all_path)))

misfit_all = FM_all[:, 0]
mag_all = FM_all[:, 1]
strike_all = FM_all[:, 2]
dip_all = FM_all[:, 3]
rake_all = FM_all[:, 4]
depth_all = FM_all[:, 5]

index_min = np.where(misfit_all == np.min(misfit_all))[0]
fm_min = FM_all[index_min]                                                      # 全局最小值


strike = np.linspace(0, 360, strike_num)                                        # strike_all
rake = np.linspace(-180, 180, rake_num)                                         # rake_all
X, Y = np.meshgrid(strike, rake)
Z = misfit_all.reshape((strike_num,rake_num))/max(misfit_all)  # 此时需要转置才能对应xy平面
Z=Z.T
for i in range(0, strike_num, 1):
    if (strike[i] &lt;= Strike) and (strike[i+1] &gt; Strike):
        strike_index = i
for i in range(0, rake_num, 1):
    if (rake[i] &lt;= Rake) and (rake[i+1] &gt; Rake):
        rake_index = i
rake_2D = Z[ :,strike_index]                                                    # rake 二维剖面的数组
strike_2D = Z[ rake_index,:]                                                    # strike 二维剖面的数组



#%% 3. plot
fig = plt.figure(figsize=(10, 10))
gs1 = gridspec.GridSpec(4, 2)
# fig.suptitle(&#39;Strike and Rake Grid-Search&#39;)
fig.subplots_adjust(wspace=0.1, hspace=0.5)


# 3.1. 3-D subplot
cmap = &#39;coolwarm&#39;                                                               # coolwarm plasma viridis
ax = plt.subplot(gs1[:-1, :], projection=&#39;3d&#39;)
# plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;Times New Roman&#39;]
surf = ax.plot_surface(X, Y, Z, cmap=cmap, shade=True, antialiased=True, rstride=1, cstride=1, alpha=0.7)
ax.contour(X, Y, Z, zdir=&#39;z&#39;, offset=0, cmap=cmap)

ax.set_xlim(0, 360)
ax.set_ylim(-180, 180)
ax.set_zlim(0, 1.1)
ax.set_xlabel(&#39;Strike&#39;)
ax.set_ylabel(&#39;Rake&#39;)
ax.zaxis.set_rotate_label(False)   # 必须禁用z轴标签的自动旋转
ax.set_zlabel(&#39;Normlized misfit&#39;, rotation=90)

x_major_locator=MultipleLocator(90)                                             # 坐标刻度间隔
y_major_locator=MultipleLocator(90)
z_major_locator=MultipleLocator(0.3)
ax.xaxis.set_major_locator(x_major_locator)
ax.yaxis.set_major_locator(y_major_locator)
ax.zaxis.set_major_locator(z_major_locator)
ax.grid(False)   # 关闭网格
# ax.invert_xaxis()  # 反转x轴
ax.xaxis.set_pane_color((1.0, 1.0, 1.0, 1.0))  # x 面的背景色设置为透明
ax.yaxis.set_pane_color((1.0, 1.0, 1.0, 1.0))  # y 面的背景色设置为透明
ax.view_init(elev=18, azim=220)    # 20 60
# ax.set_axis_off()
# ax.set_xticks([])#不显示x坐标轴
# ax.set_yticks([])#不显示y坐标轴
# ax.set_zticks([])#不显示z坐标轴

# colorbar
cb=fig.colorbar(surf, shrink=0.3, aspect=8)
font = {&#39;family&#39; : &#39;serif&#39;,
        &#39;color&#39;  : &#39;black&#39;,
        &#39;weight&#39; : &#39;normal&#39;,
        &#39;size&#39;   : 9,
        }
cb.set_label(&#39;Normlized misfit&#39;,fontdict=font)
cb.ax.tick_params(labelsize=8)  # colorbar 标签字体大小

# text
ax.text(190, -168, 0.35, &#39;F1&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,
        horizontalalignment=&#39;center&#39;,bbox = dict(facecolor = &quot;orange&quot;, alpha = 0.6))

ax.text(30, -4, 0.4, &#39;F2&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,
        horizontalalignment=&#39;center&#39;,bbox = dict(facecolor = &quot;orange&quot;, alpha = 0.6))

ax.text(260, -160, 1.1, &#39;LM&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,
        horizontalalignment=&#39;center&#39;,bbox = dict(facecolor = &quot;lime&quot;, alpha = 0.6))


ax.text(360, -170, 0.30, &#39;E1&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,
        horizontalalignment=&#39;center&#39;,bbox = dict(facecolor = &quot;m&quot;, alpha = 0.6))

ax.text(250, 0, 0.35, &#39;E2&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,
        horizontalalignment=&#39;center&#39;,bbox = dict(facecolor = &quot;m&quot;, alpha = 0.6))


# 画两条横线
ax.plot(strike,Rake*np.ones(shape=strike.shape) , zs=0, zdir=&#39;z&#39;,color=&#39;b&#39;)
ax.text(-20, -168, 0,&#39;A1&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,horizontalalignment=&#39;center&#39;)
ax.text(380, -168, 0,&#39;A2&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,horizontalalignment=&#39;center&#39;)

ax.plot(Strike*np.ones(shape=rake.shape),rake , zs=0, zdir=&#39;z&#39;,color=&#39;b&#39;)
ax.text(135, -210, 0,&#39;B1&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,horizontalalignment=&#39;center&#39;)
ax.text(135, 200, 0,&#39;B2&#39;, style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,horizontalalignment=&#39;center&#39;)

ax.text(-100, 240, 1.4,&#39;(a)&#39;,horizontalalignment=&#39;center&#39;, verticalalignment=&#39;center&#39;,\
          fontsize=20, color=&#39;k&#39;,alpha=1,zorder=1) 

#%% 3.2. strike subplot
ax = plt.subplot(gs1[-1, 1])
x = np.linspace(0, 360, strike_num)


tt = []
yy = []
for i in range(0,Num_stem,1):
    if i == 0:
        tt.append(x[0])
        yy.append(strike_2D[0])
    else:
        index = math.floor(i*strike_num/Num_stem)
        tt.append( x[index] )
        yy.append( strike_2D[index] )

markerline, stemlines, baseline=ax.stem(tt, yy, linefmt=&#39;grey&#39;, markerfmt=&#39;D&#39;, bottom=0)
markerline.set_markerfacecolor(&#39;none&#39;)
ax.set_xlabel(&#39;Strike&#39;)
ax.set_xlim(-5, 365)
ax.set_ylim(0.2, 1.1)
ax.spines[&#39;top&#39;].set_visible(False)
ax.spines[&#39;right&#39;].set_visible(False)
ax.spines[&#39;bottom&#39;].set_visible(True)
ax.spines[&#39;left&#39;].set_visible(False)
ax.get_xaxis().set_visible(True)
ax.get_yaxis().set_visible(False)
x_major_locator=MultipleLocator(60)
ax.xaxis.set_major_locator(x_major_locator)
ax.set_title(&#39;A1——A2 | rake=-170°&#39;,fontsize=15)

ax.text(-5, 1.3,&#39;(c)&#39;,horizontalalignment=&#39;center&#39;, verticalalignment=&#39;center&#39;,\
          fontsize=20, color=&#39;k&#39;,alpha=1,zorder=1) 

#%% 3.3. rake subplot
ax = plt.subplot(gs1[-1, 0])
x = np.linspace(-180, 180, rake_num)
Num_stem = 40

tt = []
yy = []
for i in range(0,Num_stem,1):
    if i == 0:
        tt.append(x[0])
        yy.append(rake_2D[0])
    else:
        index = math.floor(i*rake_num/Num_stem)
        tt.append( x[index] )
        yy.append( rake_2D[index] )

markerline, stemlines, baseline=ax.stem(tt, yy, linefmt=&#39;grey&#39;, markerfmt=&#39;D&#39;, bottom=0)
markerline.set_markerfacecolor(&#39;none&#39;)
ax.set_xlabel(&#39;Rake&#39;)
ax.set_xlim(-185, 185)
ax.set_ylim(0.2, 1.1)
ax.spines[&#39;top&#39;].set_visible(False)
ax.spines[&#39;right&#39;].set_visible(False)
ax.spines[&#39;bottom&#39;].set_visible(True)
ax.spines[&#39;left&#39;].set_visible(False)
ax.get_xaxis().set_visible(True)
ax.get_yaxis().set_visible(False)
x_major_locator=MultipleLocator(60)
ax.xaxis.set_major_locator(x_major_locator)
ax.set_title(&#39;B1——B2 | strike=138°&#39;,fontsize=15)

ax.text(-185, 1.3,&#39;(b)&#39;,horizontalalignment=&#39;center&#39;, verticalalignment=&#39;center&#39;,\
          fontsize=20, color=&#39;k&#39;,alpha=1,zorder=1) 
    
#%% 4. save figure
# plt.show()
# figurename=os.path.join(&#39;./grid1.pdf&#39;)
# fig.savefig(figurename,dpi=800, format=&#39;pdf&#39;)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(-185, 1.3, &#39;(b)&#39;)
</pre></div>
</div>
<img alt="../_images/Matplotlib_1_1.png" src="../_images/Matplotlib_1_1.png" />
</div>
</div>
</section>
<section id="d-histogram">
<h2>1D Histogram<a class="headerlink" href="#d-histogram" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#!/usr/bin/env python3
# -*- coding: utf-8 -*-
&quot;&quot;&quot;
Created on Fri Jul 30 16:16:28 2021

@author: yf
&quot;&quot;&quot;

import numpy as np
import os,sys
import json5
import matplotlib.pyplot as plt
from obspy.imaging.beachball import beachball



#%% 1.input path
sample_path      = &#39;./matplotlib_files/1d-histogram&#39;

MPI_n=30                                                                         # 第一次试验：其中 MPI-3 与 MPI-9 采样陷入了极小值，从0开始数 || 第二次实验：MPI-24
MPI_n_st           = 0
Chains_n_st        = 0
num_bins=50
N = 2000                                                                        # 从第几个开始画






#%% 2.read data
FM_all=[]
for i in range(0,MPI_n,1):
    if i!=4 and i!=12 and i!=15:
        rank_path = os.path.join(sample_path,&#39;Output_&#39;+&#39;rand_&#39;+str(i),&#39;rank_&#39;+str(MPI_n_st)+&#39;_output&#39;)
        FM_path   = os.path.join(rank_path,&#39;chain_&#39;+str(Chains_n_st)+&#39;_FM_2_accept_all&#39;)
        FM        = np.loadtxt(FM_path)
        FM_all.append(FM)

FM1=[];FM2=[]
LM1=[];LM2=[]

MPI_n = MPI_n-3

## 2.1 纠正 strike/rake 的周期跳跃问题
for i in range(0,MPI_n,1):
    for k in range(1,4,1):
        for j in range(0,FM_all[i].shape[0]):
            if k==1:                                                        # strike 周期跳跃
                if FM_all[i][j,k]&gt;360 and FM_all[i][j,k]&lt;720:
                    FM_all[i][j,k]=FM_all[i][j,k]-360
                if FM_all[i][j,k]&lt;0 and FM_all[i][j,k]&gt;(-360):
                    FM_all[i][j,k]=FM_all[i][j,k]+360
            if k==3:                                                         # rake 周期跳跃
                if FM_all[i][j,k]&gt;120:
                    FM_all[i][j,k]=FM_all[i][j,k]-360

## 2.2 分为4组解
for i in range(0,MPI_n,1):
    strike_mean = FM_all[i][:,1].mean()
    if strike_mean&gt;100 and strike_mean&lt;150:  # FM1
        FM1.append(i)
    if strike_mean&gt;0 and strike_mean&lt;80:  # FM5
        FM2.append(i)
    if strike_mean&gt;300 and strike_mean&lt;360:  # LM1
        LM1.append(i)
    if strike_mean&gt;200 and strike_mean&lt;250:  # LM2
        LM2.append(i)
    if strike_mean&gt;250 and strike_mean&lt;300:  # LM2    #                         找到未收敛的 core 每次可能不一样！！
        # print(i)
        pass

## 2.3 计算4组解的平均值
LM1_mu_all=[]
LM1_sigma_all=[]
for i in LM1:
    mu_all=[]
    sigma_all=[]
    for k in range(0,8,1):
        mu=np.around(np.mean(FM_all[i][N:,k]), decimals=5)                        # Keep two decimal places
        sigma =np.around(np.std(FM_all[i][N:,k]), decimals=5)
        mu_all.append(mu)
        sigma_all.append(sigma)
    LM1_mu_all.append(mu_all)
    LM1_sigma_all.append(sigma_all)
LM1_mu=np.around(np.mean(LM1_mu_all,axis=0),decimals=2)
LM1_sigma=np.around(np.mean(LM1_sigma_all,axis=0),decimals=2)


LM2_mu_all=[]
LM2_sigma_all=[]
for i in LM2:
    mu_all=[]
    sigma_all=[]
    for k in range(0,8,1):
        mu=np.around(np.mean(FM_all[i][N:,k]), decimals=5)                        # Keep two decimal places
        sigma =np.around(np.std(FM_all[i][N:,k]), decimals=5)
        mu_all.append(mu)
        sigma_all.append(sigma)
    LM2_mu_all.append(mu_all)
    LM2_sigma_all.append(sigma_all)
LM2_mu=np.around(np.mean(LM2_mu_all,axis=0),decimals=2)
LM2_sigma=np.around(np.mean(LM2_sigma_all,axis=0),decimals=2)


FM1_mu_all=[]
FM1_sigma_all=[]
for i in FM1:
    mu_all=[]
    sigma_all=[]
    for k in range(0,8,1):
        mu=np.around(np.mean(FM_all[i][N:,k]), decimals=5)                        # Keep two decimal places
        sigma =np.around(np.std(FM_all[i][N:,k]), decimals=5)
        mu_all.append(mu)
        sigma_all.append(sigma)
    FM1_mu_all.append(mu_all)
    FM1_sigma_all.append(sigma_all)
FM1_mu=np.around(np.mean(FM1_mu_all,axis=0),decimals=2)
FM1_sigma=np.around(np.mean(FM1_sigma_all,axis=0),decimals=2)


FM2_mu_all=[]
FM2_sigma_all=[]
for i in FM2:
    mu_all=[]
    sigma_all=[]
    for k in range(0,8,1):
        mu=np.around(np.mean(FM_all[i][N:,k]), decimals=5)                        # Keep two decimal places
        sigma =np.around(np.std(FM_all[i][N:,k]), decimals=5)
        mu_all.append(mu)
        sigma_all.append(sigma)
    FM2_mu_all.append(mu_all)
    FM2_sigma_all.append(sigma_all)

FM2_mu=np.around(np.mean(FM2_mu_all,axis=0),decimals=2)
FM2_sigma=np.around(np.mean(FM2_sigma_all,axis=0),decimals=2)




#%% 3. plot
fig, axs = plt.subplots(4, 2, dpi=800,figsize=(9, 13))
# plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;Times New Roman&#39;]
fig.subplots_adjust(wspace =0.2, hspace =0.5)
for k in range(0,8,1):
    s1 = k//2
    s2 = k%2
    for i in range(0,MPI_n,1):
        # if i!=3 and i!=9:
        if i!=24:
            mu=np.around(np.mean(FM_all[i][N:,k]), decimals=5)                        # Keep two decimal places
            sigma =np.around(np.std(FM_all[i][N:,k]), decimals=5)
        
            if i in FM1:
                facecolor = &#39;navajowhite&#39;
            elif i in FM2:
                facecolor = &#39;navajowhite&#39;
            elif i in LM1:
                facecolor = &#39;lightsteelblue&#39;
            else:
                facecolor = &#39;lightsteelblue&#39;
            n, bins, patches = axs[s1,s2].hist(FM_all[i][N:,k], num_bins, density=True,histtype=&#39;stepfilled&#39;, facecolor=facecolor,alpha=0.7)

            y = ((1 / (np.sqrt(2 * np.pi) * sigma)) *
                 np.exp(-0.5 * (1 / sigma * (bins - mu))**2))
            axs[s1,s2].plot(bins, y, &#39;--&#39;,color=facecolor,linewidth=0.5)                      # Draw a Gaussian fitting curve


    if k==0:
        # axs[s1,s2].text(5, max(y),  str(f&#39;FM1:{FM1_mu[0]}\nFM2:{FM2_mu[0]}\nLM1:{LM1_mu[0]}\nLM2:{LM2_mu[0]}&#39;), 
        # #                 style=&#39;italic&#39;, fontsize=15,verticalalignment=&#39;center&#39;,
        # horizontalalignment=&#39;center&#39;,bbox = dict(facecolor = &quot;orange&quot;, alpha = 0.6))
        axs[s1,s2].set_xlim(5,8)
        axs[s1,s2].set_xlabel(&#39;Mw&#39;, fontsize=12)
    if k==1:
        axs[s1,s2].set_xlim(0,360)
        axs[s1,s2].set_xlabel(&#39;Strike/°&#39;, fontsize=12)
    if k==2:
        axs[s1,s2].set_xlim(0,90)
        axs[s1,s2].set_xlabel(&#39;Dip/°&#39;, fontsize=12)
    if k==3:
        axs[s1,s2].set_xlim(-250,100)
        axs[s1,s2].set_xlabel(&#39;Rake/°&#39;, fontsize=12)
    if k==4:
        axs[s1,s2].set_xlim(25,26)
        axs[s1,s2].set_xlabel(&#39;Latitude/°&#39;, fontsize=12)
    if k==5:
        axs[s1,s2].set_xlim(99.4,100.6)
        axs[s1,s2].set_xlabel(&#39;Longtitude/°&#39;, fontsize=12)
    if k==6:
        axs[s1,s2].set_xlim(0,30)
        axs[s1,s2].set_xlabel(&#39;Depth/km&#39;, fontsize=12)
    if k==7:
        axs[s1,s2].set_xlim(-10,10)
        axs[s1,s2].set_xlabel(&#39;T0/s&#39;, fontsize=12)
    axs[s1,s2].spines[&#39;bottom&#39;].set_visible(True)
    axs[s1,s2].spines[&#39;top&#39;].set_visible(False)                   # Coordinate boxes are not displayed
    axs[s1,s2].spines[&#39;right&#39;].set_visible(False) 
    axs[s1,s2].spines[&#39;left&#39;].set_visible(False)
    axs[s1,s2].get_yaxis().set_visible(False)

# fig.savefig(&#39;./pdf/randFM.pdf&#39;, dpi=800, format=&#39;pdf&#39;)





#%% 4. beachball
# fig = beachball(FM1_mu[1:4], size=200, linewidth=1, facecolor=&#39;g&#39;)
# fig.savefig(&#39;./pdf/FM1.pdf&#39;, dpi=800, format=&#39;pdf&#39;)

# fig = beachball(FM2_mu[1:4], size=200, linewidth=1, facecolor=&#39;g&#39;)
# fig.savefig(&#39;./pdf/FM2.pdf&#39;, dpi=800, format=&#39;pdf&#39;)

# fig = beachball(LM1_mu[1:4], size=200, linewidth=1, facecolor=&#39;g&#39;)
# fig.savefig(&#39;./pdf/LM1.pdf&#39;, dpi=800, format=&#39;pdf&#39;)

# fig = beachball(LM2_mu[1:4], size=200, linewidth=1, facecolor=&#39;g&#39;)
# fig.savefig(&#39;./pdf/LM2.pdf&#39;, dpi=800, format=&#39;pdf&#39;)





#%% 5. save
# fp = open(os.path.join(&#39;./pdf/FM_mu_sigma.txt&#39;), &#39;w&#39;)
# for m in range(0,len(FM1_mu)):
#     fp.write(str(FM1_mu[m]))
#     fp.write(&#39;\t&#39;)
#     fp.write(str(FM1_sigma[m]))
#     fp.write(&#39;\t&#39;)
# fp.write(&#39;\n&#39;)
# for m in range(0,len(FM2_mu)):
#     fp.write(str(FM2_mu[m]))
#     fp.write(&#39;\t&#39;)
#     fp.write(str(FM2_sigma[m]))
#     fp.write(&#39;\t&#39;)
# fp.write(&#39;\n&#39;)
# for m in range(0,len(LM1_mu)):
#     fp.write(str(LM1_mu[m]))
#     fp.write(&#39;\t&#39;)
#     fp.write(str(LM1_sigma[m]))
#     fp.write(&#39;\t&#39;)
# fp.write(&#39;\n&#39;)
# for m in range(0,len(LM2_mu)):
#     fp.write(str(LM2_mu[m]))
#     fp.write(&#39;\t&#39;)
#     fp.write(str(LM2_sigma[m]))
#     fp.write(&#39;\t&#39;)
# fp.write(&#39;\n&#39;)
# fp.close()
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Matplotlib_3_0.png" src="../_images/Matplotlib_3_0.png" />
</div>
</div>
</section>
<section id="id1">
<h2>2D Histogram<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>#!/usr/bin/env python3
# -*- coding: utf-8 -*-
&quot;&quot;&quot;
Created on Sun Mar 21 00:20:35 2021

@author: Fu Yin (yinfu@mail.ustc.edu.cn) at USTC

This script:
    1) plot hist


Modify history:
    1) Mar 21 00:20:35 2021   ||    Fu Yin at USTC    ||    The initial release.
    2) Jun 28 11:08:02 2021   ||    Fu Yin at USTC    ||    Add figure format parameter.
&quot;&quot;&quot;

import matplotlib.pyplot as plt
import numpy as np
import os
import sys
from math import sqrt

##############################################################################
def plot_hist(FM_all,FM_accept_all,num_bins,num_std,labels_name,Fixed_FM,InvType,fig_format):
    FM = FM_all
    figurename=os.path.join(&#39;hist.&#39;+fig_format)
    
    if InvType == &#39;mt&#39;:
        N_all = 11
    elif InvType == &#39;dc&#39;:
        N_all = 8
    elif InvType == &#39;sf&#39;:
        N_all = 8
    elif InvType == &#39;mt&#39;:
        N_all = 5

    N = Fixed_FM.count(&#39;variable&#39;)                                          # plot: The number of subgraphs of a row

    delete_list=[]
    for i in range(0,N_all,1):
        if Fixed_FM[i]!=&#39;variable&#39;:
            delete_list.append(i)

    FM = np.delete(FM,delete_list, axis=1)                                  # The delete solution that is a fixed parameter


    FM_mean=np.zeros(shape=(N))
    FM_sigma=np.zeros(shape=(N))
    for i in range(0,N,1):
        FM_mean[i]=np.mean(FM[0:,i])                                        # FM The mean of each parameter
        FM_sigma[i]=np.std(FM[0:,i])                                        # FM The standard deviation of each parameter

    FM_used = FM.copy()                                                     # strike rake cycle skip
    if InvType==&#39;dc&#39;:
        if FM_mean[1]&gt;360 and FM_mean[1]&lt;720:
            FM_used[:,1]=FM_used[:,1]-360
            FM_mean[1]=FM_mean[1]-360
        if FM_mean[1]&lt;0 and FM_mean[1]&gt;(-360):
            FM_used[:,1]=FM_used[:,1]+360
            FM_mean[1]=FM_mean[1]+360

        if FM_mean[3]&gt;180 and FM_mean[3]&lt;540:
            FM_used[:,3]=FM_used[:,3]-360
            FM_mean[3]=FM_mean[3]-360
        if FM_mean[3]&lt;(-180) and FM_mean[3]&gt;(-540):
            FM_used[:,3]=FM_used[:,3]+360
            FM_mean[3]=FM_mean[3]+360

    plt.style.use(&#39;default&#39;)                                                # Use the default plotting style (make sure it&#39;s not the ggplot style)
    fig, axs = plt.subplots(N, N, dpi=800,figsize=(16, 16))
    # plt.rcParams[&#39;font.sans-serif&#39;] = [&#39;Times New Roman&#39;]
    
    for i in range(0,N,1):
        for j in range(0,N,1):
            x=FM_used[:,i]
            y=FM_used[:,j]
            axs[i,j].get_xaxis().set_visible(False)                         # Do not display the axes
            axs[i,j].get_yaxis().set_visible(False)
            if j==0:
                axs[i,j].get_yaxis().set_visible(True)
                axs[i,j].set_ylabel(labels_name[i],fontsize=19)             # The left axis labels
            if i==N-1:
                axs[i,j].get_xaxis().set_visible(True)
                axs[i,j].set_xlabel(labels_name[j],fontsize=19)             # The bottom axis labels
            
            if i&lt;j:
                axs[i,j].set_axis_off()                                     # The upper right part of the image is not displayed
            
            if i&gt;j:
                h, xx, yy, p=axs[i,j].hist2d( y,x, bins=(50, 50), cmap=plt.cm.gist_earth_r)   # hist2d
                x_start = FM_mean[j]-num_std*FM_sigma[j]                    # Adjust the range of the coordinate axes
                x_end = FM_mean[j]+num_std*FM_sigma[j]
                y_start = FM_mean[i]-num_std*FM_sigma[i]
                y_end = FM_mean[i]+num_std*FM_sigma[i]
                axs[i, j].set_xlim(x_start,x_end)
                axs[i, j].set_ylim(y_start,y_end)
                axs[i,j].scatter(FM_mean[j],FM_mean[i],s=100,c=&#39;tab:red&#39;)   # Draw the average value (red dots)
                # plt.clf()
                # axs[i,j].imshow(h, origin = &quot;lower&quot;, interpolation = &quot;gaussian&quot;,cmap=plt.cm.gist_earth_r)
                cov_yx = np.cov(y.T, x.T)                                   # Covariance matrix
                cov0_yx = np.around(cov_yx[0,1]/sqrt(cov_yx[0,0]*cov_yx[1,1]), decimals=2)  # The correlation coefficient
                
                cov0_yx_text = &#39;cov0: &#39;+str(cov0_yx)
                axs[i,j].text(x_start, y_end,cov0_yx_text,horizontalalignment=&#39;left&#39;, verticalalignment=&#39;top&#39;,
                                fontsize=12, color=&#39;black&#39;,bbox = dict(facecolor = &quot;k&quot;, alpha = 0.05))                      # Mark the correlation coefficient SHIFT
                
            if i==j:
                axs[i,j].spines[&#39;top&#39;].set_visible(False)                   # Coordinate boxes are not displayed
                axs[i,j].spines[&#39;right&#39;].set_visible(False) 
                axs[i,j].spines[&#39;left&#39;].set_visible(False)
                axs[i,j].spines[&#39;bottom&#39;].set_visible(False)
                axs[i,j].get_yaxis().set_visible(False)
        

                n, bins, patches = axs[i,j].hist(x, num_bins, density=True,histtype=&#39;stepfilled&#39;, facecolor=&#39;orange&#39;,
                                                    alpha=0.5)                 # histgram
    
                mu=np.around(FM_mean[i], decimals=2)                        # Keep two decimal places
                sigma =np.around(FM_sigma[i], decimals=2)
            
                y = ((1 / (np.sqrt(2 * np.pi) * sigma)) *
                        np.exp(-0.5 * (1 / sigma * (bins - mu))**2))
                axs[i,j].plot(bins, y, &#39;--&#39;,color=&#39;g&#39;)                      # Draw a Gaussian fitting curve
                str_hist=&#39; $\mu=&#39;+str(mu)+&#39;$, $\sigma=&#39;+str(sigma)+&#39;$&#39;
                axs[i,j].set_title(r&#39; $\mu=&#39;+str(mu)+&#39;$, $\sigma=&#39;+str(sigma)+&#39;$&#39;)
            
                x_start = FM_mean[j]-num_std*FM_sigma[j]                    # Adjust the range of the coordinate axes
                x_end = FM_mean[j]+num_std*FM_sigma[j]
                y_start = FM_mean[i]-num_std*FM_sigma[i]
                y_end = FM_mean[i]+num_std*FM_sigma[i]
                axs[i,j].set_xlim(x_start,x_end)
                axs[i,j].spines[&#39;bottom&#39;].set_visible(True)                 # Shows the axis of coordinates at the bottom

    fig.subplots_adjust(wspace =0.1, hspace =0.1)
    # fig.savefig(figurename,dpi=800, format=fig_format)
##############################################################################


sample_path      = &#39;./matplotlib_files/2d-histogram/&#39;
fig_format       = &#39;pdf&#39;                              # history: Jun 28 11:08:02 2021
MPI_n          = 1
Chains_n       = 1
num_bins       = 50                                    # plot hist2d: the number of grid
num_std        = 5                                      # range of axes in each subgraph (mean +- several times standard deviation)
labels_name    = [&#39;Mw&#39;,&#39;Strike/°&#39;,&#39;Dip/°&#39;,&#39;Rake/°&#39;,&#39;Latitude/°&#39;,&#39;Longtitude/°&#39;,&#39;Depth/km&#39;,&#39;T0/s&#39;] # labels:[&#39;mw&#39;,&#39;strike/°&#39;,&#39;dip/°&#39;,&#39;rake/°&#39;,&#39;x/km&#39;,&#39;y/km&#39;,&#39;z/km&#39;,&#39;t0/s&#39;]
N_start        = 0
N_start_accept = 0
Fixed_FM       = [&#39;variable&#39;,&#39;variable&#39;,&#39;variable&#39;,&#39;variable&#39;, &#39;variable&#39;,&#39;variable&#39;,&#39;variable&#39;,&#39;variable&#39;,]   
InvType        = &#39;dc&#39;                                      # &#39;mt&#39; &#39;dc&#39; &#39;sf&#39; &#39;ep&#39;
N_k            = 2000

for i in range(0,MPI_n,1):
    rank_path = os.path.join(sample_path,&#39;rank_&#39;+str(i)+&#39;_output&#39;)
    for j in range(0,Chains_n,1):
        FM_2_all_path = os.path.join(rank_path,&#39;chain_&#39;+str(j)+&#39;_FM_2_all&#39;)
        FM_2_accept_path = os.path.join(rank_path,&#39;chain_&#39;+str(j)+&#39;_FM_2_accept_all&#39;)
        if i==0 and j==0:
            FM_2_all        = np.loadtxt(FM_2_all_path)[N_start:,:]
            FM_2_accept_all = np.loadtxt(FM_2_accept_path)[N_start_accept:,:]
        else:
            FM_2_all        = np.vstack( ( FM_2_all, np.loadtxt(FM_2_all_path)[N_start:,:] ) )
            FM_2_accept_all = np.vstack( ( FM_2_accept_all, np.loadtxt(FM_2_accept_path)[N_start_accept:,:] ) )

plot_hist(FM_2_all,FM_2_accept_all,num_bins,num_std,labels_name,Fixed_FM,InvType,fig_format)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Matplotlib_5_0.png" src="../_images/Matplotlib_5_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./geo_software"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="GeoSoftware.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Geophysics Software</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="PyGMT.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PyGMT</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Fu Yin<br/>
  
      &copy; Copyright 2021–2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>